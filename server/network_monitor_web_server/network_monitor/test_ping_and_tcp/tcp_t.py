# -*- coding: utf-8 -*-
"""
-------------------------------------------------
   File Name：     tcp_t
   Description :
   Author :       'li'
   date：          2019/9/20
-------------------------------------------------
   Change Activity:
                   2019/9/20:
-------------------------------------------------
"""
from scapy.layers.inet import IP, TCP
from scapy.sendrecv import sr1

__author__ = 'li'
ipp = """10.40.12.146	9900
188.10.23.17	80
188.8.29.34	7711
188.10.22.19	7001
188.8.18.33	5024
10.40.22.19	8899
10.40.22.21	31928
188.8.18.12	32002
188.10.22.11	9446
172.16.133.166	3266
172.36.0.171	3099
9.234.15.22	22364
10.40.12.126	21
188.8.25.14	26379
188.8.18.30	32002
10.40.12.30	21
188.8.18.31	5027
188.8.25.15	26379
10.40.12.182	22
188.8.27.33	25672
188.8.18.18	32001
188.8.18.34	32001
188.8.27.33	51080
188.8.18.18	5074
10.40.22.22	7000
188.10.23.32	3098
188.8.25.11	18086
172.36.0.171	1098
188.8.18.28	32002
188.10.22.12	21
188.8.18.30	5024
188.8.18.31	5025
172.36.0.172	1099
10.40.12.199	9009
10.40.32.21	1883
188.8.27.32	15671
188.8.18.30	5027
188.10.23.32	28080
188.8.18.29	32001
188.8.18.15	32001
188.8.18.34	5026
188.10.22.13	21
10.1.1.9	9606
188.8.18.23	32001
188.8.18.16	5074
172.36.0.167	1098
188.8.25.11	18085
10.40.12.104	4500
188.8.29.3	8889
10.40.12.118	9001
10.40.22.27	8097
188.8.18.13	32002
172.16.132.162	21
172.36.0.166	1098
188.8.18.27	5026
188.8.18.31	32002
188.8.18.19	5074
188.8.18.35	5026
188.8.18.29	5026
188.10.10.11	25108
9.156.46.242	9009
188.10.22.13	9080
172.16.1.123	1418
188.8.18.12	5074
188.10.10.15	22
188.8.18.26	5074
188.8.27.16	7000
127.0.0.1	11056
188.8.18.24	5074
188.8.18.24	32001
188.10.10.13	25108
172.16.134.33	3266
172.36.0.172	3099
10.40.22.21	10002
172.36.0.164	3098
10.40.22.20	8899
172.36.0.229	9017
188.8.18.16	32001
188.8.18.19	32002
10.40.32.22	12333
10.40.31.109	21
172.36.0.164	1099
188.10.23.32	1098
10.40.12.112	21
188.8.18.35	5024
172.36.0.163	1098
188.10.23.32	10068
188.8.27.20	7000
188.8.21.30	20001
188.10.22.11	21
188.8.18.27	5074
188.8.23.12	10919
188.8.18.34	32002
188.8.18.28	5025
188.8.18.27	5024
188.8.29.32	7620
172.36.0.229	21
188.8.18.29	5024
188.8.18.11	5074
172.36.0.229	9018
10.40.32.18	8100
172.36.0.172	3098
188.10.10.12	25108
188.8.18.33	5027
188.8.18.36	32001
10.40.12.172	21
188.8.18.35	32002
188.8.18.31	5024
188.8.18.27	5027
188.10.22.11	9080
172.36.0.171	5005
188.8.18.26	32001
172.16.113.203	21
188.8.18.22	5074
10.40.12.119	21
188.8.18.36	5074
188.8.27.34	4369
188.8.28.22	6039
188.8.18.11	32001
188.8.18.20	5074
188.8.18.32	5074
188.8.25.11	18087
188.8.29.32	8854
188.8.18.11	32002
172.36.0.163	1099
10.40.12.94	21
10.40.22.21	7000
188.8.18.32	5027
172.16.134.34	3266
188.8.18.20	32002
188.8.20.11	10005
8.8.8.161	21
188.8.2.15	21
188.8.18.24	32002
188.8.18.30	5025
172.36.0.167	1099
188.8.18.14	5074
188.8.18.28	5074
188.8.18.36	5027
172.36.0.172	5005
172.17.36.15	22
188.8.27.34	5671
188.8.18.21	32002
188.8.27.33	80
188.8.29.3	7711
188.8.27.34	15671
188.8.27.33	56729
10.1.1.9	21
188.8.18.35	5074
188.8.20.12	10005
172.36.0.167	5005
188.8.18.33	32001
192.168.10.10	21
188.10.23.32	7001
188.8.29.33	8854
188.8.18.23	32002
172.16.136.16	11018
188.8.27.19	7000
172.16.133.77	21
188.8.18.15	32002
188.8.18.25	5074
188.8.18.31	32001
188.8.29.33	7620
188.8.18.27	32001
172.36.0.166	3099
188.8.27.33	55672
172.36.0.171	3098
172.36.0.166	5005
188.8.18.31	5026
10.40.22.20	8091
172.16.133.162	50001
188.8.18.29	5025
10.40.32.18	21
188.8.18.35	32001
10.40.22.19	8091
188.8.28.21	6039
188.8.18.36	32002
188.8.18.19	32001
188.8.18.22	32001
188.8.18.25	32002
188.8.18.17	32001
188.8.18.27	5025
172.36.0.195	21
188.8.25.12	6379
188.8.18.28	5026
9.234.101.28	28364
188.8.18.36	5025
10.40.12.98	22
188.8.18.14	32002
10.40.12.47	21
188.8.18.34	5027
10.40.22.18	1515
188.8.18.25	32001
188.8.18.18	32002
172.36.0.164	3099
188.8.18.13	32001
188.8.18.27	32002
172.36.0.163	5005
188.8.18.16	32002
188.8.18.23	5074
188.8.18.17	32002
188.8.18.29	5027
188.8.29.35	7711
188.8.18.35	5025
10.40.32.21	8096
172.36.0.164	1098
188.8.25.11	18082
10.40.32.27	8081
188.8.23.11	10920
188.8.18.29	5074
172.16.1.58	21
20.102.5.252	80
188.8.27.33	8081
10.40.12.85	22
188.8.20.13	10005
188.8.18.33	5025
172.16.1.77	22
188.8.18.34	5025
172.36.0.166	3098
188.8.27.32	25672
10.40.12.98	5680
188.8.25.11	18080
188.10.23.16	7101
188.8.18.30	5074
188.8.18.32	5024
188.10.23.32	1099
188.8.27.32	5671
188.8.18.31	5074
188.8.18.14	32001
188.8.18.36	28087
172.36.0.164	5005
188.8.2.12	5001
172.56.136.19	9080
10.40.12.124	1521
188.10.22.13	9446
188.8.18.32	32001
10.40.12.146	21
10.40.12.84	8088
188.8.25.11	6379
10.40.12.87	21
188.8.18.22	32002
188.8.18.36	5026
172.36.0.163	3098
188.8.18.33	5026
188.8.18.17	5074
188.8.28.19	7001
188.8.27.32	4369
172.16.133.167	3266
188.8.27.33	18080
188.10.10.19	25108
188.8.18.32	32002
172.36.0.163	3099
188.8.27.33	15671
172.17.36.16	22
172.36.0.166	1099
188.8.18.13	5074
172.36.0.167	3099
188.8.18.34	5024
188.8.18.29	32002
172.16.1.58	45678
188.8.18.12	32001
10.3.97.130	21
188.8.18.32	5025
10.40.12.128	8010
188.8.18.28	5024
172.170.24.81	21
188.8.27.33	56720
172.36.0.167	3098
188.8.25.13	6379
188.10.23.32	3099
188.8.22.11	8022
10.40.12.76	21
10.3.97.130	4500
172.57.29.104	9080
188.8.18.28	32001
188.8.21.31	20001
10.40.12.181	22
188.8.25.11	18090
188.8.18.30	32001
10.40.31.109	80
188.8.27.16	4521
9.234.51.102	80
188.8.18.35	5027
188.8.28.20	6039
10.40.32.28	8096
172.36.0.171	1099
188.8.18.30	5026
188.8.18.28	5027
188.8.22.12	8022
192.168.10.10	39099
188.8.18.33	32002
172.16.1.123	22
188.10.10.20	25108
188.8.18.21	32001
188.8.18.26	32002
188.8.18.32	5026
188.8.18.21	5074
10.40.12.178	22
188.8.18.15	5074
188.8.18.36	5024
172.36.0.172	1098
188.8.27.33	8087
188.10.23.32	5005
188.8.28.18	7001
10.40.12.104	21
10.40.31.60	8282
10.40.31.117	22
10.40.12.177	22
10.40.22.20	28364
188.8.18.20	32001
188.8.27.33	5671
10.40.12.87	8812
188.8.25.16	26379
188.8.27.33	4369
188.8.27.34	25672
188.8.18.24	32001
172.36.0.163	1098
188.8.18.24	32002
8.8.8.161	21
188.8.18.27	5027
188.8.18.15	32001
188.8.18.33	5024
172.36.0.172	3099
10.40.22.20	8899
188.8.27.34	25672
172.36.0.171	1098
188.8.18.36	5027
188.8.18.21	32001
172.36.0.164	1099
188.10.23.32	28080
188.8.18.28	5027
9.234.101.28	28364
188.8.28.21	6039
188.8.29.35	7711
188.8.18.32	5025
188.8.18.32	5024
192.168.10.10	21
10.1.1.9	21
172.36.0.172	3098
188.8.28.20	6039
10.40.12.98	5680
172.16.133.166	3266
172.36.0.195	21
188.8.27.33	8081
10.40.32.22	12333
10.40.12.87	21
188.8.18.32	32001
172.16.134.34	3266
188.8.18.12	5074
188.8.18.18	32002
10.40.12.104	21
10.40.12.118	9001
188.8.18.12	32001
188.10.10.19	25108
188.8.27.33	5671
188.8.18.11	32002
10.40.20.182	21
188.8.18.18	5074
188.8.25.15	26379
10.40.32.21	1883
188.8.18.29	5074
188.8.25.16	26379
188.8.18.35	5027
10.40.12.126	21
188.8.18.28	5025
10.40.12.112	21
188.8.18.31	5027
188.8.18.16	5074
188.8.18.15	5074
188.8.18.35	5025
188.8.18.33	5025
188.8.27.33	51080
188.8.18.34	5026
172.36.0.167	3099
172.16.1.58	45678
188.8.18.33	32001
188.8.18.20	32001
188.10.22.11	9446
188.8.18.30	32002
188.10.22.13	9080
188.8.27.16	7000
188.8.18.30	5026
188.10.22.13	21
10.40.22.21	31928
188.8.18.36	28087
10.40.32.27	8081
10.40.12.30	21
188.8.27.20	7000
188.8.18.23	32001
188.8.18.31	5074
188.8.18.13	5074
188.10.10.20	25108
188.8.18.27	32001
188.8.18.20	5074
188.8.2.15	21
10.40.12.146	21
10.40.22.21	7000
10.40.12.199	9009
188.8.2.12	5001
172.16.134.33	3266
10.40.22.21	10002
172.36.0.166	1098
188.8.18.36	32002
188.8.23.12	10919
188.8.18.13	32001
188.8.18.27	5026
188.8.18.33	5026
188.8.18.26	5074
188.8.18.35	5024
10.40.12.124	1521
188.8.27.16	4521
10.40.12.76	21
172.16.1.58	21
188.8.18.23	32002
10.40.20.5	28020
188.8.18.19	5074
172.36.0.164	5005
188.8.18.28	5026
188.8.25.11	18085
188.8.25.11	18080
188.8.18.30	5024
188.8.18.11	5074
192.168.10.10	39099
188.8.27.33	25672
188.8.21.30	20001
188.8.27.32	15671
10.1.1.9	9606
188.8.29.3	7711
10.40.32.18	8100
188.8.25.11	18086
188.8.18.25	32001
"""

lines = ipp.split('\n')
to_test = []
for line in lines:
    if len(line) < 5:
        continue
    ip, port = line.split('	')
    to_test.append([ip, port])
rest = []
for test in to_test:
    ip, port = test
    package = IP(dst=ip) / TCP(dport=int(port), flags="S")
    res = sr1(package, verbose=False, timeout=2)
    if res is None:
        rest.append(1)
    else:
        print(res['TCP'].flags)
        rest.append(test)
    print(rest)
